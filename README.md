**ç¬¬äº”å±Šè®¡å›¾å¤§èµ›èµ›é“ä¸€ B æ¦œæäº¤è¯´æ˜æ–‡æ¡£**ï¼š

---

### ğŸ“„ `contest1_å­¦ç‚¹å„¿ä¸œè¥¿_bæ¦œç¬¬15å


# ç¬¬äº”å±Šè®¡å›¾æ¯”èµ› - èµ›é“ä¸€ B æ¦œæäº¤è¯´æ˜æ–‡æ¡£

## 1. å›¢é˜Ÿä¿¡æ¯
- å›¢é˜Ÿåç§°ï¼šå­¦ç‚¹å„¿ä¸œè¥¿
- Bæ¦œæ’åï¼šç¬¬15å
- è”ç³»äººå§“åï¼šæ¢ç£Š
- å¾®ä¿¡å·ï¼šleiGeGer_Sir
- è”ç³»ç”µè¯ï¼š17735469179

## 2.æäº¤è¯´æ˜
ä»£ç åŒAæ¦œæäº¤ä»£ç ï¼Œæœ€ä¼˜ç»“æœ Aæ¦œcheckpoint1.pkl

## 3.å¼€æºé“¾æ¥

## 2. é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®ä¸“æ³¨äºä¹³è…ºç™Œè¶…å£°å›¾åƒçš„å¤šç±»åˆ«ç—…ç¶è¯†åˆ«ï¼Œæå‡ºäº†ä¸€ç§å¤šåˆ†æ”¯èåˆæ¨¡å‹ `Res101_Mamba_ITE_UNet_GraphPlus`ï¼Œ
ç»“åˆäº†å±€éƒ¨/å…¨å±€ç‰¹å¾å»ºæ¨¡ã€ç»“æ„å¢å¼ºä¸åˆ†å‰²å…ˆéªŒï¼Œæ˜¾è‘—æå‡äº†è·¨ç»“æ„çš„è§†è§‰æ³›åŒ–èƒ½åŠ›å’Œåˆ¤åˆ«èƒ½åŠ›ã€‚

æ ¸å¿ƒæ¨¡å—åŒ…æ‹¬ï¼š

- **ResNet101 ä¸»å¹²ç½‘ç»œ**ï¼šæå–å›¾åƒæ·±å±‚ç‰¹å¾ï¼›
- **Mamba åˆ†æ”¯**ï¼šæ•æ‰é•¿ç¨‹ä¾èµ–ï¼Œè¡¥è¶³ CNN è¡¨è¾¾å±€é™ï¼›
- **ITE åˆ†æ”¯**ï¼šå»ºæ¨¡å±€éƒ¨ç»“æ„é—´ç›¸äº’å…³ç³»ï¼›
- **UNet åˆ†å‰²è¾…åŠ©åˆ†æ”¯**ï¼šæä¾›ç»„ç»‡è¾¹ç•Œå…ˆéªŒï¼›
- **GCN åˆ†æ”¯**ï¼šå¼•å…¥å›¾ç»“æ„è¾…åŠ©åˆ¤åˆ«ï¼›
- **æ–¹å‘æ³¨æ„åŠ›ï¼ˆDirectional Attentionï¼‰**ï¼šå»ºæ¨¡æ–¹å‘ä¸€è‡´æ€§ï¼›
- **ç»“æ„é‡åŒ–ä¸å¼•å¯¼æœºåˆ¶**ï¼šå¢å¼ºç»“æ„ä¿¡æ¯æ³¨å…¥ï¼›
- **ScoreSoftmax**ï¼šå¢å¼ºè¯„åˆ†å±‚ç¨³å®šæ€§ï¼›
- **GRL + Prototype æœºåˆ¶**ï¼šå¼•å…¥è·¨åŸŸæ³›åŒ–èƒ½åŠ›ã€‚

æ¨¡å‹åŸºäº Jittor æ¡†æ¶å¼€å‘ï¼Œè®­ç»ƒä¸æ¨ç†è¿‡ç¨‹å¯å®Œå…¨å¤ç°ï¼Œæœ€ç»ˆåœ¨ A æ¦œå–å¾—ä¼˜å¼‚æˆç»©ã€‚



## 3. ä»£ç ç»“æ„è¯´æ˜

ä»£ç ä½äº `/workspace/code`ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```
â”œâ”€â”€ ckps/                 # ä¿å­˜å·²ç»è®­ç»ƒå¥½çš„æƒé‡æ–‡ä»¶ï¼Œå°†æƒé‡æ–‡ä»¶å¤åˆ¶åˆ°ç›¸åº”æ–‡ä»¶å¤¹åï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œæ¨ç†æ‰§è¡Œ
â”œâ”€â”€ ckpts/                # å›¾åƒåˆ†å‰²æ¨¡å‹æƒé‡ç›®å½•
â”œâ”€â”€ datasets/             # æ•°æ®é›†ç›®å½•ï¼ˆä¿å­˜é¢å¤–çš„æ•°æ®é›†BUSBRAã€BUSUCLMã€BUSIã€MERGE_DATAï¼‰
â”œâ”€â”€ Dockerfile            # Dockerå°è£…æ–‡ä»¶
â”œâ”€â”€ EMCADNet.py           # åˆ†å‰²æ¨¡å—EMCADNetç»“æ„å®šä¹‰
â”œâ”€â”€ emcad_decoder.py      # EMCADNetè§£ç å™¨æ¨¡å—
â”œâ”€â”€ inference.sh          # æ¨ç†æ‰§è¡Œè„šæœ¬
â”œâ”€â”€ main.py               # ä¸»å…¥å£ï¼ˆé›†æˆè®­ç»ƒ / æµ‹è¯•é€»è¾‘ï¼‰
â”œâ”€â”€ main_pertrain.py      # é¢„è®­ç»ƒå…¥å£ï¼ˆé€‚ç”¨äºæŸäº›ckptï¼‰
â”œâ”€â”€ model_save/           # è®­ç»ƒä¸­é—´ç»“æœè¾“å‡ºç›®å½•ä»¥åŠcheckpointå­˜æ”¾ä½ç½®
â”œâ”€â”€ models_utils.py       # æ¨¡å‹å·¥å…·å‡½æ•°æ¨¡å—
â”œâ”€â”€ nnUnet_jittor.py      # nnUNetç»“æ„å®šä¹‰ï¼ˆä¸å¯ä¿®æ”¹ï¼‰
â”œâ”€â”€ nnUnet_main.py        # nnUNetç›¸å…³è®­ç»ƒå…¥å£
â”œâ”€â”€ requirements.txt      # Pythonä¾èµ–è¯´æ˜
â”œâ”€â”€ result.txt            # æ¨ç†ç»“æœè¾“å‡ºç¤ºä¾‹
â”œâ”€â”€ TestSetA/             # æµ‹è¯•é›†ï¼ˆæ–‡ä»¶å¤¹ï¼‰
â”œâ”€â”€ TrainSet/             # è®­ç»ƒé›†ï¼ˆæ–‡ä»¶å¤¹ï¼‰
â”œâ”€â”€ *.sh / *.py           # å„ç‰ˆæœ¬è®­ç»ƒ/æ¨ç†è„šæœ¬


````


## 4. ç¯å¢ƒé…ç½®ï¼ˆåŸºäº Docker é•œåƒï¼‰

- **åŸºç¡€é•œåƒ**ï¼š`jittor/jittor:cuda12.2-cudnn8`
- **Python ç‰ˆæœ¬**ï¼š3.9.21
- **ä¾èµ–è¯´æ˜**ï¼š
  - jittor==1.3.9.14
  - numpy, scikit-learn, opencv-python, matplotlib, tqdm, pandas, pyyaml ç­‰å·²åœ¨ Dockerfile ä¸­å®‰è£…

### Docker é•œåƒæ„å»ºå‘½ä»¤

```bash
docker build -t contest1_team_37 .
```

```
### é•œåƒéªŒè¯å‘½ä»¤

```bash
docker run --gpus all -it contest1_team_37 bash
```


## 4. ç¯å¢ƒé…ç½®ï¼ˆåŸºäº anaconda è™šæ‹Ÿç¯å¢ƒï¼‰


- **Python ç‰ˆæœ¬**ï¼š3.9.21
- **ä¾èµ–è¯´æ˜**ï¼š
  - jittor==1.3.9.14
  - numpy, scikit-learn, opencv-python, matplotlib, tqdm, pandas, pyyaml ç­‰å·²åœ¨ è¯¦è§ requirements.txt

### anaconda è™šæ‹Ÿç¯å¢ƒ æ„å»ºå‘½ä»¤

```bash
conda create -n jittor_contest python==3.9.21
conda activate jittor_contest
```


### å®‰è£…ç›¸å…³åº“æ–‡ä»¶

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```





---

## 5. è®­ç»ƒä¸æ¨ç†æµç¨‹

### ğŸ‹ï¸â€â™€ï¸ æœ€åé˜¶æ®µè®­ç»ƒå‘½ä»¤ï¼š

```bash
bash train.sh
```

* æ¨¡å‹è¾“å‡ºä¿å­˜äº `/workspace/model_save/`
* shæ— æ³•æ‰§è¡Œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ `train.sh` å†…å‚æ•°ï¼Œæ‰‹åŠ¨æ‰§è¡Œå¯¹åº”çš„pyæ–‡ä»¶
* ä½¿ç”¨è®­ç»ƒè„šæœ¬ï¼š`main.py`


### ğŸ‹ï¸â€â™€ï¸ å®Œæ•´è®­ç»ƒå‘½ä»¤ï¼š

```bash
bash emcad_main.sh
bash nnUnet_main.sh
bash pertrain.sh
bash train.sh
```

* `emcad_main.sh` ä¸ `nnUnet_main.sh` æ‰§è¡Œemcadä¸nnUnetçš„å›¾åƒåˆ†å‰²è®­ç»ƒä»£ç 
* `pertrain.sh` æ‰§è¡Œåœ¨é¢å¤–æ•°æ®é›†ä¸Šçš„é¢„è®­ç»ƒæ“ä½œ
* `train.sh`ä½¿ç”¨è®­ç»ƒè„šæœ¬ï¼š`main.py` æ‰§è¡Œè®­ç»ƒä»»åŠ¡


### ğŸ” æ¨ç†å‘½ä»¤ï¼ˆè¯„ä¼° Aæ¦œï¼‰ï¼š

```bash
bash inference.sh
```

* æ¨ç†æ•°æ®è·¯å¾„ï¼šé»˜è®¤ `/workspace/TestSetA`
* é¢„æµ‹ç»“æœä¿å­˜åœ¨ `/workspace/result.txt`
* æ¨ç†è„šæœ¬ï¼š`main.py`

---

## 6. Checkpoint è¯´æ˜

| æ–‡ä»¶å                         | æ¨¡å‹ç»“æ„ç‰ˆæœ¬              | å¤‡æ³¨         |
| --------------------------- | ------------------- | ---------- |
| `checkpoint1.pkl` | å¤šåˆ†æ”¯èåˆï¼Œå«åˆ†å‰²/æ–¹å‘æ³¨æ„/ç»“æ„å¼•å¯¼ | æœ€ç»ˆç”¨äº A æ¦œæäº¤ |
| `pertrain_checkpoint1.pkl`   | åœ¨é¢å¤–æ•°æ®é›†ä¸Šçš„æ¨¡å‹é¢„è®­ç»ƒ   | æ¨¡å‹é¢„è®­ç»ƒ      |
| `emcadnet_best_modelv4.pkl`      | EMCADNetå›¾ç‰‡åˆ†å‰²ç½‘ç»œè®­ç»ƒç»“æœ       | åˆ†å‰²maskç”¨äºè®­ç»ƒ     |
| `best_model.pkl`      | nnUetå›¾ç‰‡åˆ†å‰²ç½‘ç»œè®­ç»ƒç»“æœ       | åˆ†å‰²maskç”¨äºè®­ç»ƒ     |

æ‰€æœ‰æ¨¡å‹é»˜è®¤ä¿å­˜åœ¨ `/workspace/[ckpts/][model_save/]`ã€‚

---

## 7. æ³¨æ„äº‹é¡¹ä¸å¤ç°è¯´æ˜

* è¿è¡Œæ¨ç†å‰è¯·ç¡®è®¤ GPU å¯ç”¨ (`nvidia-smi`)ï¼›
* è‹¥æ¨¡å‹è·¯å¾„æˆ–æ•°æ®è·¯å¾„éœ€ä¿®æ”¹ï¼Œè¯·æ›´æ–°  shell è„šæœ¬ï¼›
* é»˜è®¤ä½¿ç”¨ `jt.flags.device_id = 0` è¿è¡Œäº GPU æ¨¡å¼ï¼›
* ckpt2_main.pyã€ckpt2_main_pertrain.pyã€ckpt2_models_utils.py æ˜¯checkpoint2.pklçš„ä»£ç é€»è¾‘,
  æ‰§è¡Œç­–ç•¥åŒ main.py ã€main_pertrain.pyã€model_utils.py
* ckpt3_main.pyã€ckpt3_main_pertrain.pyã€ckpt3_models_utils.py æ˜¯checkpoint3.pklçš„ä»£ç é€»è¾‘,
  æ‰§è¡Œç­–ç•¥åŒ main.py ã€main_pertrain.pyã€model_utils.py

---

## 8. é™„å½•ï¼šDocker é•œåƒå¯¼å‡º/å¯¼å…¥å‘½ä»¤

```bash
# é•œåƒå¯¼å‡º
docker save contest1_team_37 > contest1_team_37.tar

# é•œåƒå¯¼å…¥
docker load < contest1_team_37.tar
```

